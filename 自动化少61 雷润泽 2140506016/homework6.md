# 数字图像与视频处理

## 第六次作业报告

----

姓名：雷润泽

班级：自动化少61

学号：2140506016

----

**摘要：** 本次作业完成的主要内容为设计多种滤波器对经过退化或带有噪声的图像进行恢复处理。

### 1.对带有高斯噪声的图像进行恢复处理

**思路分析：** 高斯噪声是指概率密度函数服从高斯分布的一类噪声。如果高斯噪声的功率谱密度又是均匀分布的，则称其为高斯白噪声。对于图像噪声的处理方式有很多，有空域处理方式，也有频域处理方式，既有线性的滤波处理方法，也有非线性的处理方法。在本次作业中，共使用了14种滤波器对带有噪声的图像进行了处理。

采用的第一类滤波器为空域均指滤波器，算术均值滤波器是对带有噪声的图像g(x,y)的以(x,y)为中心的m×n的邻域内的像素的灰度值求和并除以像素点的总数作为处理后的图像在点(x,y)上的灰度值，用公式表示为

![](http://latex.codecogs.com/gif.latex?\hat{f}(x,y)=\frac{1}{mn}\sum_{S_{xy}}g(s,t))

几何均值滤波器是对带有噪声的图像g(x,y)的以(x,y)为中心的m×n的邻域内的像素的灰度值求成绩并开像素点的总数次方作为处理后的图像在点(x,y)上的灰度值，用公式表示为

![](http://latex.codecogs.com/gif.latex?\hat{f}(x,y)=(\prod_{S_{xy}}g(s,t))^{1/mn})

谐波均值滤波器用公式表示为

![](http://latex.codecogs.com/gif.latex?\hat{f}(x,y)=\frac{1}{\sum_{S_{xy}}\frac{1}{g(s,t)}})

![](http://www.forkosh.com/mathtex.cgi?x=\frac{-b\pm\sqrt{b^2-4ac}}{2a})

$ \hat{f}(x,y)=(\prod_{S_{xy}}g(s,t))^{1/mn} $


图像低通滤波器主要用于实现图像的平滑和降噪处理。频域高斯低通滤波器由下式给出

![](http://latex.codecogs.com/gif.latex?H(u,v)=e^{-D^2(u,v)/2D_0^2})

频域巴特沃斯低通滤波器则为

![](http://latex.codecogs.com/gif.latex?H(u,v)=\frac{1}{1+[D(u,v)/D_0]^{2n}})

其中，D(u,v)为频域中的点(u,v)到频率矩形中心的距离，D0为低通滤波器的截止频率，n为巴特沃斯低通滤波器的阶次。

使用matlab编写函数`gaussianf`以生成频域高斯滤波器(函数代码参见`/codes/gaussianf.txt`)，编写函数`butterworthf`以生成频域巴特沃斯滤波器(函数代码参见`/codes/butterworthf.txt`)，并编写函数`ff`实现对图像的频域处理过程，(函数代码参见`/codes/ff.txt`)分别调用这些函数即可实现对图像频域低通滤波处理。

**代码实现：** 参见`/codes/h5_1.txt`

**处理结果：**

test1.pgm的处理结果，其中使用的高斯低通滤波器的截止频率为25，使用的巴特沃斯低通滤波器的截止频率为25，阶次为3。

![test1.pgm的处理结果](paperpics/h5_1_test1.bmp "h5_1_test1.bmp")

test2.tif的处理结果，其中使用的高斯低通滤波器的截止频率为25，使用的巴特沃斯低通滤波器的截止频率为25，阶次为3。

![test2.tif的处理结果](paperpics/h5_1_test2.bmp "h5_1_test2.bmp")

注意以上两图中，为了清晰显示处理前后图像的频谱，已对频谱的模值进行了归一化和放大处理。

比较处理结果与原始图像可知，高斯低通滤波器和巴特沃斯低通滤波器都都可以实现对图像的低通滤波处理，实现对图像的平滑和降噪。对比两种滤波器的处理结果，从空域上看处理结果，巴特沃斯低通滤波器的平滑效果比高斯滤波器更强，从处理后的图像频谱和功率谱比中则可以看出，二者的区别在于巴特沃斯低通滤波器的过渡带宽较小，最大通带衰减较小，最小阻带衰减较大，因此在截止频率相同的条件下，其低通效果比高斯低通滤波器更明显，因此对图像的平滑效果更强。

### 2.频域高斯、巴特沃斯高通滤波器

**思路分析：** 图像高通滤波器主要用于实现图像的增强和边缘提取等处理。频域高斯高通滤波器由下式给出

![](http://latex.codecogs.com/gif.latex?H(u,v)=1-e^{-D^2(u,v)/2D_0^2})

频域巴特沃斯高通滤波器则为

![](http://latex.codecogs.com/gif.latex?H(u,v)=\frac{1}{1+[D_0/D(u,v)]^{2n}})

其中，D(u,v)为频域中的点(u,v)到频率矩形中心的距离，D0为高通滤波器的截止频率，n为巴特沃斯高通滤波器的阶次。

使用matlab编写函数`gaussianf`以生成频域高斯滤波器(函数代码参见`/codes/gaussianf.txt`)，编写函数`butterworthf`以生成频域巴特沃斯滤波器(函数代码参见`/codes/butterworthf.txt`)，并编写函数`ff`实现对图像的频域处理过程，(函数代码参见`/codes/ff.txt`)分别调用这些函数即可实现对图像频域高通滤波处理。

**代码实现：** 参见`/codes/h5_2.txt`

**处理结果：**

test3_corrupt.pgm的处理结果，其中使用的高斯低高滤波器的截止频率为20，使用的巴特沃斯高通滤波器的截止频率为20，阶次为3。

![test3_corrupt.pgm的处理结果](paperpics/h5_2_test3.bmp "h5_2_test3.bmp")

test4 copy.bmp的处理结果，其中使用的高斯低高滤波器的截止频率为20，使用的巴特沃斯高通滤波器的截止频率为20，阶次为3。

![test4 copy.bmp的处理结果](paperpics/h5_2_test4.bmp "h5_2_test4.bmp")

注意以上两图中，为了清晰显示处理前后图像的频谱，已对频谱的模值进行了归一化和放大处理。

比较处理结果与原始图像可知，高斯高通滤波器和巴特沃斯高通滤波器都都可以实现对图像的高通滤波处理，实现对图像的边缘提取。对比两种滤波器的处理结果，其差异在空域上看不太明显，但在频域上，可以从处理后的图像频谱和功率谱比中看出两种滤波器处理后的结果存在较为明显的区别，巴特沃斯高通滤波器的过渡带宽较小，最大通带衰减较小，最小阻带衰减较大，因此在截止频率相同的条件下，巴特沃斯低通滤波器处理后的低频成分更少。

### 3.频域拉普拉斯、钝化模板高通滤波器

**思路分析：** 频域拉普拉斯高通滤波器由下式给出

![](http://latex.codecogs.com/gif.latex?H(u,v)=-4\pi^2(u^2+v^2))

频域钝化模板的基本原理则是先对图像进行低通滤波处理，由于低通滤波器对图像的边缘处作用效果明显，故原图像与低通滤波后的图像的差即可以反映原图的边缘分布状况，再将差值乘以一个系数并叠加在原图像上，即可实现对图像的边缘增强处理。由于在频率域有

![](http://latex.codecogs.com/gif.latex?1-H_{LP}(u,v)=H_{HP}(u,v))

即（1-低通滤波函数）=高通滤波函数，因此钝化模板处理一般可表示为

![](http://latex.codecogs.com/gif.latex?H(u,v)=1+kH_{HP}(u,v))

其中k为高提升滤波系数。

使用matlab编写函数`laplacef`以生成频域拉普拉斯滤波器(函数代码参见`/codes/laplacef.txt`)，钝化模板处理中的高通滤波器则直接使用了巴特沃斯高通滤波器，并编写函数`ff`实现对图像的频域处理过程，(函数代码参见`/codes/ff.txt`)分别调用这些函数即可实现对图像频域高通滤波处理。

**代码实现：** 参见`/codes/h5_3.txt`

**处理结果：**

test3_corrupt.pgm的处理结果，其中，在钝化模板中处理中使用的巴特沃斯高通滤波器的截止频率为25，阶次为3，高提升滤波系数为2.5。

![test3_corrupt.pgm的处理结果](paperpics/h5_3_test3.bmp "h5_3_test3.bmp")

test4 copy.bmp的处理结果，其中，在钝化模板中处理中使用的巴特沃斯高通滤波器的截止频率为25，阶次为3，高提升滤波系数为2.5。注意在对test4的处理中，由于laplace滤波器的处理结果灰度范围过小，显示结果不清晰，故在此图中以对其处理后的灰度作了20倍的放大处理。

![test4 copy.bmp的处理结果](paperpics/h5_3_test4.bmp "h5_3_test4.bmp")

注意以上两图中，为了清晰显示处理前后图像的频谱，已对频谱的模值进行了归一化和放大处理。

将频域拉普拉斯高通滤波器与上题中的高斯高通滤波器和巴特沃斯高通滤波器作对比，一方面拉普拉斯滤波器对于高频信息具有的放大能力，因此相比于高斯高通滤波器和巴特沃斯高通滤波器，拉普拉斯滤波器能够更好地提取图像的高频信息，但另一方面拉普拉斯滤波器也对图像噪声更加敏感，此外，拉普拉斯滤波器在除频域的零频点之外的频率上，对于低频信息的衰减作用较小，导致处理后的图像对比度较低，需要通过进一步的处理才能够观看。

在钝化模板处理中，选取了大于1的k值实现高提升滤波的效果，可见其处理结果相当于将图像的边缘高频信息提取并放大后叠加在原始图像上，可以实现对图像边缘的增强效果。

## 附录

### 程序代码

参见目录`/codes`下的文件，其中文件`h5_*.txt`为作业对应题目的matlab脚本代码，其他文件为使用到的自行编写的matlab函数文件。

### 处理结果

处理后的图像参见目录`/images`下的文件，其中文件名带有`gaussian_low`的文件为高斯低通滤波器的处理结果，文件名带有`gaussian_high`的文件为高斯高通滤波器的处理结果，文件名带有`butterworth_low`的文件为巴特沃斯低通滤波器的处理结果，文件名带有`butterworth_high`的文件为巴特沃斯高通滤波器的处理结果，文件名带有`laplace`的文件为拉普拉斯滤波器的处理结果，文件名带有`unmask`的文件为钝化模板的处理结果。

报告中使用的图片参见目录`/paperpics`下的文件。

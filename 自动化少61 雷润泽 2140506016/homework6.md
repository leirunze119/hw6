# 数字图像与视频处理

## 第六次作业报告

----

姓名：雷润泽

班级：自动化少61

学号：2140506016

----

**摘要：** 本次作业完成的主要内容为设计多种滤波器对经过退化或带有噪声的图像进行恢复处理。

### 1.对带有高斯噪声的图像进行恢复处理

**思路分析：** 高斯噪声是指概率密度函数服从高斯分布的一类噪声。如果高斯噪声的功率谱密度又是均匀分布的，则称其为高斯白噪声。对于图像噪声的处理方式有很多，有空域处理方式，也有频域处理方式，既有线性的滤波处理方法，也有非线性的处理方法。在本次作业中，共使用了14种滤波器对带有噪声的图像进行了处理。

采用的第一类滤波器为空域均值滤波器，是将图像在空域上进行某种局部均值处理。算术均值滤波器是对带有噪声的图像g(x,y)的以(x,y)为中心的m×n的邻域内的像素的灰度值求和并除以像素点的总数作为处理后的图像在点(x,y)上的灰度值，用公式表示为

![](http://latex.codecogs.com/gif.latex?\hat{f}(x,y)=\frac{1}{mn}\sum_{(s,t)\in{S_{xy}}}g(s,t))

几何均值滤波器是对带有噪声的图像g(x,y)的以(x,y)为中心的m×n的邻域内的像素的灰度值求成绩并开像素点的总数次方作为处理后的图像在点(x,y)上的灰度值，用公式表示为

![](http://latex.codecogs.com/gif.latex?\hat{f}(x,y)=(\prod_{(s,t)\in{S_{xy}}}g(s,t))^{\frac{1}{mn}})

谐波均值滤波器用公式表示为

![](http://latex.codecogs.com/gif.latex?\hat{f}(x,y)=\frac{mn}{\sum_{(s,t)\in{S_{xy}}}\frac{1}{g(s,t)}})

逆谐波均值滤波器用公式表示为

![](http://latex.codecogs.com/gif.latex?\hat{f}(x,y)=\frac{\sum_{(s,t)\in{S_{xy}}}g(s,t)^{Q+1}}{\sum_{(s,t)\in{S_{xy}}}g(s,t)^Q})

第二类滤波器为空域统计排序滤波器，是将图像在空域上进行某种局部统计处理。中值滤波器是取图像g(x,y)的以(x,y)为中心的m×n的邻域内的像素的灰度值的中位数作为处理后的图像在点(x,y)上的灰度值，用公式表示为

![](http://latex.codecogs.com/gif.latex?\hat{f}(x,y)=median_{(s,t)\in{S_{xy}}}(g(s,t)))

最大值滤波器是取图像g(x,y)的以(x,y)为中心的m×n的邻域内的像素的灰度值的最大值作为处理后的图像在点(x,y)上的灰度值，用公式表示为

![](http://latex.codecogs.com/gif.latex?\hat{f}(x,y)=max_{(s,t)\in{S_{xy}}}(g(s,t)))

最小值滤波器是取图像g(x,y)的以(x,y)为中心的m×n的邻域内的像素的灰度值的最小值作为处理后的图像在点(x,y)上的灰度值，用公式表示为

![](http://latex.codecogs.com/gif.latex?\hat{f}(x,y)=min_{(s,t)\in{S_{xy}}}(g(s,t)))

中点滤波器是取图像g(x,y)的以(x,y)为中心的m×n的邻域内的像素的灰度值的最大值和最小值的算术平均数作为处理后的图像在点(x,y)上的灰度值，用公式表示为

![](http://latex.codecogs.com/gif.latex?\hat{f}(x,y)=\frac{1}{2}[max_{(s,t)\in{S_{xy}}}(g(s,t))+min_{(s,t)\in{S_{xy}}}(g(s,t))])

修正α均值滤波器与算术均值滤波器类似，但是其去掉了邻域内灰度值最大和最小的若干像素点，以排除噪声的干扰，用公式表示为

![](http://latex.codecogs.com/gif.latex?\hat{f}(x,y)=\frac{1}{mn-d}\sum_{(s,t)\in{S_{xy}}}g_r(s,t))

第三类滤波器为自适应滤波器。自适应局部降低噪声滤波器是基于图像全局的均值和方差与局部均值和方差的关系对每个邻域内的滤波参数进行调整，用公式表示为

![](http://latex.codecogs.com/gif.latex?\hat{f}(x,y)=g(x,y)-\frac{\sigma_\eta^2}{\sigma_L^2}(g(x,y)-m_L))

自适应中值滤波器则是通过根据图像局部的灰度值的统计分布特征逐步增大邻域范围并取其中值的方法实现的。

第四类滤波器为频域选频滤波器。低通滤波器可以通过其平滑作用减弱噪声，本次作业选用巴特沃斯低通滤波器，其滤波函数为

![](http://latex.codecogs.com/gif.latex?H(u,v)=\frac{1}{1+[D(u,v)/D_0]^{2n}})

对于一些分布在特定频率范围内的噪声，可以使用带阻滤波器去除，本次作业选用巴特沃斯带阻滤波器，其滤波函数为

![](http://latex.codecogs.com/gif.latex?H(u,v)=\frac{1}{1+[\frac{B_WD(u,v)}{D_0^2-D^2(u,v)}]^{2n}})

其中带宽

![](http://latex.codecogs.com/gif.latex?B_w=D_2-D_1)

中心频率

![](http://latex.codecogs.com/gif.latex?D_0^2=D_2D_1)

D1为带阻滤波器的下限截止频率，D2为带阻滤波器的上限截止频率。

陷波滤波器阻止特定频率点及其邻域内的频率分量。最佳陷波滤波的表达式为

![](http://latex.codecogs.com/gif.latex?\hat{f}(x,y)=g(x,y)-w(x,y)\eta(x,y))

其中w(x,y)为权重，对于点(x,y)处的权重，其计算方法为在以(x,y)为中心的邻域内计算

![](http://latex.codecogs.com/gif.latex?w(x,y)=\frac{\overline{g(x,y)\eta(x,y)}-\overline{g}(x,y)\overline{\eta}(x,y)}{\overline{\eta^2}(x,y)-\overline{\eta}^2(x,y)})

使用matlab编写函数`recover`以利用以上14种滤波器进行图像的复原处理(函数代码参见`/codes/recover.txt`)，并编写函数`butterworthbandreject`以生成频域巴特沃斯带阻滤波器(函数代码参见`/codes/butterworthbandreject.txt`)，分别调用这些函数即可实现对图像频域低通滤波处理。图像的噪声添加则直接使用matlab内置函数imnoise。

**代码实现：** 参见`/codes/h6_1.txt`

**处理结果：**

lena.bmp的处理结果如下图所示，其中添加的高斯噪声的均值为0，方差为0.01，使用的各个滤波器的参数如下：

各种空域均值滤波器的窗口尺寸均为5×5，逆谐波滤波器的参数Q=1；

各种空域统计排序滤波器的窗口尺寸均为5×5，修正α均值滤波器的参数d=6；

自适应局部滤波器窗口尺寸为5×5，自适应中值滤波器最小窗口尺寸为3×3，最大窗口尺寸为7×7；

巴特沃斯低通滤波器的截止频率为40，巴特沃斯带阻滤波器下限截止频率为40，上限截止频率为100，二者阶次均为3。

![lena.bmp的处理结果](paperpics/h6_1.bmp "h6_1.bmp")

注意上图中，为了清晰显示处理前后图像的频谱，已对频谱的模值进行了归一化和放大处理。由于噪声兼具正和负值，故显示时将其正负范围压缩至正值，即负值接近于黑色，正值接近于白色，零值为灰色。

比较各种滤波器复原出的图像，在四种均值滤波器中，算术均值滤波器和Q=1的逆谐波滤波器处理效果较好，但几何均值滤波器和谐波均值滤波器由于在邻域内任何一个0值点都会导致计算出的均值为0，故处理后的图像出现了大量黑点，复原效果较差。

在五种统计排序滤波器中，复原效果最好的是修正α均值滤波器，其去除最大和最小灰度值的处理方式较大程度上减弱了噪声对于均值计算的影响；其次是中值滤波器，但是在带有噪声的图像中的噪点较为密集的区域，这种处理方式依然会受到噪声干扰，留下部分噪点；中点滤波器的效果不太理想，因为噪声的干扰在灰度值上多表现为过大和过小的灰度值，因此中点滤波器的计算往往是在噪声值的基础上进行的，因此其结果与原始图像存在较大差异；最大值和最小值滤波器不能很好的复原原始图像，最大值滤波器能够消除噪声为负值的噪点，但对噪声为正值的噪点反而有放大作用，且处理后图像的整体灰度值偏亮，最小值滤波器则刚好相反，能够消除噪声为正值的噪点，但对噪声为负值的噪点反而有放大作用，且处理后图像的整体灰度值偏暗。

自适应局部滤波器对高斯噪声有一定的抑制效果，而自适应中值滤波器的处理结果则不够理想。

低通滤波器可以很好的消除高斯噪声，因为高斯噪声在频域上多分布在高频区，但其对于图像本身也具有明显的平滑作用，使图像变得模糊；观察高斯噪声的频谱可知高斯噪声在频域上不是带限的，故使用巴特沃斯带阻滤波器处理时，由于其有高频分量通过，故无论如何调节参数都无法滤除全部噪声，且由于其在低频带具有低通特性，故对图像还有一定的平滑模糊效果，因此带阻滤波器对于高斯噪声的处理效果很差；最佳陷波滤波对噪声的抑制效果极佳，但其平滑特性较弱，故处理后的结果出现了锯齿现象。

### 2.对带有椒盐噪声的图像进行恢复处理

**思路分析：** 椒盐噪声是指图像中存在脉冲式分布的亮点和暗点。类似于对高斯噪声的处理，在本次作业中，共使用了14种滤波器对带有噪声的图像进行了处理。

**代码实现：** 参见`/codes/h6_2.txt`

**处理结果：**

lena.bmp的处理结果如下图所示，其中添加的椒盐噪声的密度为0.1，使用的各个滤波器的参数如下：

各种空域均值滤波器的窗口尺寸均为5×5，逆谐波滤波器的参数Q=1；

各种空域统计排序滤波器的窗口尺寸均为5×5，修正α均值滤波器的参数d=6；

自适应局部滤波器窗口尺寸为5×5，自适应中值滤波器最小窗口尺寸为3×3，最大窗口尺寸为7×7；

巴特沃斯低通滤波器的截止频率为40，巴特沃斯带阻滤波器下限截止频率为40，上限截止频率为100，二者阶次均为3。

![lena.bmp的处理结果](paperpics/h6_2.bmp "h6_2.bmp")

注意上图中，为了清晰显示处理前后图像的频谱，已对频谱的模值进行了归一化和放大处理。由于噪声兼具正和负值，故显示时将其正负范围压缩至正值，即负值接近于黑色，正值接近于白色，零值为灰色。

比较各种滤波器复原出的图像。四种均值滤波器的处理结果都不太理想。算术均值滤波的处理效果略好于另外三者。但由于椒盐噪声的值呈现脉冲特性，因此会对邻域内的均值产生较大影响，因此滤波后仍存在一些噪点。几何均值滤波和谐波均值滤波的处理结果呈现出与处理高斯噪声时类似的结果，由于零点的影响，导致较多的邻域内的均值都为零，且椒盐噪声添加的零点数量大于高斯噪声，因此出现了大面积的黑色区域，复原效果很差。Q=1的逆谐波滤波器处理效果与前述两种滤波器相反，椒噪声基本被去除，但出现了较多的白色区域，对盐噪声去除效果较差。

在对于椒盐噪声的处理中，比较三种不同参数的逆谐波滤波器的处理结果：Q=-1时为谐波滤波器，对于盐噪声有较好的抑制作用，但对椒噪声的处理效果很差；Q=1时为本次作业使用的逆谐波滤波器，对于椒噪声有较好的抑制作用，但对盐噪声的处理效果很差；Q=0时为算术均值滤波器，其对于椒噪声和盐噪声都有一定程度的抑制作用。由此可见，对于逆谐波滤波器的参数Q，当Q>0时可以抑制椒噪声，而当Q<0时则可以抑制盐噪声。

在五种统计排序滤波器中，复原效果最好的是中值滤波器，由于椒盐噪声在噪点处的灰度值均为0或255，故中值滤波几乎完全消除了椒盐噪声的噪点，美中不足在于图像边缘处出现了一定程度的锯齿现象。修正α均值滤波器较好地抑制了噪声，但没能完全消除噪点，这与添加的椒盐噪声密度较大且选取的滤波器参数d较小有关。由于椒盐噪声在噪点处的灰度值均为0或255，最大值滤波器、最小值滤波器、中点滤波器不仅无法起到复原图像的效果，反而加重的噪声的影响，最大值滤波器的处理结果几乎全是白色，最小值滤波器的处理结果几乎全是黑色，中点滤波器的处理结果则几乎全是灰度值相近的灰色。

自适应局部滤波器对在一定程度上对椒盐噪声有抑制作用，但无法消除噪点，而自适应中值滤波器的处理结果较为理想，与中值滤波器相似，且在细节的恢复上更胜一筹。

低通滤波器可以很好的消除椒盐噪声，但其对于图像本身也具有明显的平滑作用，使图像变得模糊；观察椒盐噪声的频谱可知椒盐噪声在频域上不是带限的，故使用巴特沃斯带阻滤波器处理时，由于其有高频分量通过，故无论如何调节参数都无法滤除全部噪声，且由于其在低频带具有低通特性，故对图像还有一定的平滑模糊效果，因此带阻滤波器对于椒盐噪声的处理效果很差；最佳陷波滤波对噪声的抑制效果较好，但仍留下了少量的噪点。

### 3.维纳滤波器与约束最小二乘滤波

**思路分析：** 维纳滤波器可以实现对于经过退化且带有噪声的图像的复原处理，其基本原理是使恢复图像与原始图像的均方误差最小，即优化目标为

![](http://latex.codecogs.com/gif.latex?e=E||f(x,y)-h_w(x,y)*g(x,y)||^2)

其中hw(x,y)为维纳滤波器，g(x,y)为待处理的图像，f(x,y)为原始图像。考虑到图像空域与频域的能量有对应关系，由此以上优化问题与以下问题等价

![](http://latex.codecogs.com/gif.latex?e=E||F(u,v)-H_w(u,v)G(u,v)||^2)

其中G(u,v)可以近似表示为

![](http://latex.codecogs.com/gif.latex?G(u,v)=H(u,v)F(u,v)+\eta(u,v))

其中H(u,v)为退化函数，η(u,v)为噪声的频谱。代入并将范数展开为共轭乘积形式，并按项展开。假设噪声的均值为0，则只含有η(u,v)或η*(u,v)的项的期望为0，略去后得

![](http://latex.codecogs.com/gif.latex?e=(1-H_w(u,v)H(u,v))(1-H_w^*(u,v)H^*(u,v))||F(u,v)||^2+||H_w(u,v)||^2||\eta(u,v)||^2)

由于优化变量为Hw(u,v)，故要求目标函数最小值，应使e对Hw(u,v)的偏导数为0，即

![](http://latex.codecogs.com/gif.latex?\frac{\partial{e}}{\partial{H_w}}=H_w^*(u,v)||\eta(u,v)||^2-H(u,v)(1-H_w^*(u,v)H^*(u,v))||F(u,v)||^2=0)

求解得

![](http://latex.codecogs.com/gif.latex?H_w(u,v)=\frac{H^*(u,v)||F(u,v)||^2}{||H(u,v)||^2||F(u,v)||^2+||\eta(u,v)||^2})

将化简整理整理为功率谱形式，得经过维纳滤波器恢复后的图像为

![](http://latex.codecogs.com/gif.latex?\hat{F}(u,v)=\frac{H^*(u,v)}{||H(u,v)||^2+S_{\eta}(u,v)/S_f(u,v)}G(u,v))

约束最小二乘滤波处理则可以表示为

![](http://latex.codecogs.com/gif.latex?\hat{F}(u,v)=\frac{H^*(u,v)}{||H(u,v)||^2+\gamma||P(u,v)||^2}G(u,v))

其中γ为参数P(u,v)为拉普拉斯算子的频谱。

此外，本次作业中采用的退化函数为一种运动模糊模型，其表达式为

![](http://latex.codecogs.com/gif.latex?H(u,v)=\frac{T}{\pi(ua+vb)}sin[\pi(ua+vb)]e^{-j\pi(ua+vb)})

其中T,a,b均为参数。

**代码实现：** 参见`/codes/h6_3.txt`

**处理结果：**

lena.bmp的处理结果如下图所示，其中退化函数参数为T=1，a=0.015，b=-0.015，添加的高斯噪声的均值为0，方差为0.01，约束最小二乘滤波器的参数γ=0.5。

![lena.bmp的处理结果](paperpics/h6_3.bmp "h6_3.bmp")

注意上图中，为了清晰显示处理前后图像的频谱，已对频谱的模值进行了归一化和放大处理。由于噪声兼具正和负值，故显示时将其正负范围压缩至正值，即负值接近于黑色，正值接近于白色，零值为灰色。

观察处理结果可知，维纳滤波器课约束最小二乘滤波器都可以实现对图像的恢复处理，处理效果不佳可能是由于退化函数对图像的频域信息造成了较大的损失，这一点可以由原始图像的频谱和模糊后图像的频谱之间的对比看出。

两种滤波器相比较而言，维纳滤波器的处理结果较好，但这是建立在噪声模型已知的条件下，而在噪声模型未知的情况下，只能对噪声模型进行近似估计，维纳滤波器的处理效果将会变差。而约束最小二乘滤波器则无需知道噪声模型就可以进行处理，但是其参数选取存在一定的困难，迭代法计算参数使计算时间大幅延长。

## 附录

### 程序代码

参见目录`/codes`下的文件，其中文件`h6_*.txt`为作业对应题目的matlab脚本代码，其他文件为使用到的自行编写的matlab函数文件。

### 处理结果

处理后的图像参见目录`/images`下的文件，其中文件名带有`gaussian`的文件为添加高斯噪声后的恢复处理结果，文件名的后缀为选用的滤波器；文件名带有`saltpepper`的文件为添加椒盐噪声后的恢复处理结果，文件名的后缀为选用的滤波器；`lena_wiener.bmp`为维纳滤波器的处理结果；`lena_constainedleastsquare.bmp`为约束最小二乘滤波器的处理结果。

报告中使用的图片参见目录`/paperpics`下的文件。
